"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={53524:e=>{e.exports=require("@prisma/client")},98432:e=>{e.exports=require("bcryptjs")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},47317:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var a={};t.r(a),t.d(a,{POST:()=>c,dynamic:()=>u,revalidate:()=>p});var i=t(49303),s=t(88716),o=t(60670),n=t(87070);let u="force-dynamic",p=0;async function c(e){if(!process.env.DATABASE_URL||"build"===process.env.VERCEL_ENV)return n.NextResponse.json({error:"Service unavailable during build"},{status:503});try{let{verifyPassword:r,generateToken:a}=await Promise.all([t.e(188),t.e(456)]).then(t.bind(t,95456)),{email:i,password:s}=await e.json();if(!i||!s)return n.NextResponse.json({error:"Email e senha s\xe3o obrigat\xf3rios"},{status:400});let{PrismaClient:o}=await Promise.resolve().then(t.t.bind(t,53524,23)),u=new o;try{let e=await u.user.findUnique({where:{email:i}});if(!e||!await r(s,e.password))return await u.$disconnect(),n.NextResponse.json({error:"Credenciais inv\xe1lidas"},{status:401});await u.$disconnect();let t=a(e.id),o=n.NextResponse.json({success:!0,data:{user:{id:e.id,email:e.email,name:e.name,role:e.role},token:t}});return o.cookies.set("auth-token",t,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800}),o}catch(e){throw await u.$disconnect(),e}}catch(e){return console.error("Login error:",e),n.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"D:\\sistema-auto-pecas\\src\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:h}=l,x="/api/auth/login/route";function v(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[276,972],()=>t(47317));module.exports=a})();