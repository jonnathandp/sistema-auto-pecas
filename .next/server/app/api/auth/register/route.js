"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={53524:e=>{e.exports=require("@prisma/client")},98432:e=>{e.exports=require("bcryptjs")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},52081:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{POST:()=>c,dynamic:()=>u,revalidate:()=>p});var a=t(49303),o=t(88716),i=t(60670),n=t(87070);let u="force-dynamic",p=0;async function c(e){if(!process.env.DATABASE_URL||"build"===process.env.VERCEL_ENV)return n.NextResponse.json({error:"Service unavailable during build"},{status:503});try{let{hashPassword:r,generateToken:s}=await Promise.all([t.e(188),t.e(456)]).then(t.bind(t,95456)),{email:a,password:o,name:i}=await e.json();if(!a||!o||!i)return n.NextResponse.json({error:"Todos os campos s\xe3o obrigat\xf3rios"},{status:400});if(o.length<6)return n.NextResponse.json({error:"A senha deve ter pelo menos 6 caracteres"},{status:400});let{PrismaClient:u}=await Promise.resolve().then(t.t.bind(t,53524,23)),p=new u;try{if(await p.user.findUnique({where:{email:a}}))return await p.$disconnect(),n.NextResponse.json({error:"Email j\xe1 est\xe1 em uso"},{status:409});let e=await r(o),t=await p.user.create({data:{email:a,password:e,name:i,role:"USER"}});await p.$disconnect();let u=s(t.id),c=n.NextResponse.json({success:!0,data:{user:{id:t.id,email:t.email,name:t.name,role:t.role},token:u}});return c.cookies.set("auth-token",u,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800}),c}catch(e){throw await p.$disconnect(),e}}catch(e){return console.error("Register error:",e),n.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"D:\\sistema-auto-pecas\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:h}=d,x="/api/auth/register/route";function g(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972],()=>t(52081));module.exports=s})();