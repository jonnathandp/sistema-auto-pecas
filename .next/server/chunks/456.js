"use strict";exports.id=456,exports.ids=[456,538],exports.modules={5456:(e,r,n)=>{n.d(r,{Sk:()=>f,c_:()=>l,generateToken:()=>d,verifyPassword:()=>o});var s=n(8432),t=n.n(s),i=n(1482),a=n.n(i),u=n(3538);let c=process.env.JWT_SECRET||"fallback-secret-key";async function l(e){return t().hash(e,12)}async function o(e,r){return t().compare(e,r)}function d(e){return a().sign({userId:e},c,{expiresIn:"7d"})}async function f(e){let r=function(e){try{return a().verify(e,c)}catch{return null}}(e);return r?await u.prisma.user.findUnique({where:{id:r.userId},select:{id:!0,email:!0,name:!0,role:!0}}):null}},3538:(e,r,n)=>{n.d(r,{prisma:()=>t});var s=n(3524);let t=globalThis.prisma??new s.PrismaClient}};