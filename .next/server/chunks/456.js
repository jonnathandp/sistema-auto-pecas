"use strict";exports.id=456,exports.ids=[456],exports.modules={95456:(e,r,n)=>{n.d(r,{Sk:()=>T,generateToken:()=>f,hashPassword:()=>m,verifyPassword:()=>E});var t=n(98432),s=n.n(t),a=n(41482),i=n.n(a),l=n(77234),o=n(77210),c=n(53797),u=n(13539),d=n(53524);let w=process.env.JWT_SECRET||"fallback-secret-key";function p(){return new d.PrismaClient}async function m(e){return s().hash(e,12)}async function E(e,r){return s().compare(e,r)}function f(e){return i().sign({userId:e},w,{expiresIn:"7d"})}async function T(e){try{let r=function(e){try{return i().verify(e,w)}catch{return null}}(e);if(!r)return null;let{PrismaClient:t}=await Promise.resolve().then(n.t.bind(n,53524,23)),s=new t;try{let e=await s.user.findUnique({where:{id:r.userId},select:{id:!0,email:!0,name:!0,role:!0}});return await s.$disconnect(),e}catch(e){throw await s.$disconnect(),e}}catch(e){return console.error("Error getting user from token:",e),null}}process.env.DATABASE_URL&&(0,u.N)(p()),(0,c.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;if(!process.env.DATABASE_URL)return console.warn("DATABASE_URL not available during build"),null;try{let r=p(),n=await r.user.findUnique({where:{email:e.email}});if(!n||!await s().compare(e.password,n.password))return await r.$disconnect(),null;return await r.$disconnect(),{id:n.id,email:n.email,name:n.name,role:n.role}}catch(e){return console.error("Auth error:",e),null}}}),(0,l.Z)({clientId:process.env.GOOGLE_CLIENT_ID||"",clientSecret:process.env.GOOGLE_CLIENT_SECRET||""}),(0,o.Z)({clientId:process.env.GITHUB_ID||"",clientSecret:process.env.GITHUB_SECRET||""}),process.env.NEXTAUTH_SECRET}};